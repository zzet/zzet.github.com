<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#FFFFFF"><title>Project configuration. Part 1. Railsclub intro. &#183; Andrey Kumanyaev</title><meta name=title content="Project configuration. Part 1. Railsclub intro. &#183; Andrey Kumanyaev"><script type=text/javascript src=https://zzet.org/js/appearance.min.8a082f81b27f3cb2ee528df0b0bdc39787034cf2cc34d4669fbc9977c929023c.js integrity="sha256-iggvgbJ/PLLuUo3wsL3Dl4cDTPLMNNRmn7yZd8kpAjw="></script><link type=text/css rel=stylesheet href=https://zzet.org/css/main.bundle.min.100caa677b4bc416cdd884107b203b4869f9b413a19aa57d12069fb826f1abe9.css integrity="sha256-EAyqZ3tLxBbN2IQQeyA7SGn5tBOhmqV9EgafuCbxq+k="><meta name=description content="
      
        
      
    "><meta name=keywords content="ruby,ruby,on,rails,configuration,monilith,microservice"><meta name=robots content="all"><link rel=canonical href=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/"><meta property="og:site_name" content="Andrey Kumanyaev"><meta property="og:title" content="Project configuration. Part 1. Railsclub intro."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="archive"><meta property="article:published_time" content="2017-10-29T00:00:00+00:00"><meta property="article:modified_time" content="2017-10-29T00:00:00+00:00"><meta property="article:tag" content="Configuration"><meta property="article:tag" content="Conference"><meta property="article:tag" content="Railsclub 2017"><meta name=twitter:card content="summary"><meta name=twitter:title content="Project configuration. Part 1. Railsclub intro."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"Project configuration. Part 1. Railsclub intro.","headline":"Project configuration. Part 1. Railsclub intro.","inLanguage":"en","url":"https:\/\/zzet.org\/archive\/2017-10-29-project-configuration-railsclub-intro\/","author":{"@type":"Person","name":"Andrey Kumanyaev"},"copyrightYear":"2017","dateCreated":"2017-10-29T00:00:00\u002b00:00","datePublished":"2017-10-29T00:00:00\u002b00:00","dateModified":"2017-10-29T00:00:00\u002b00:00","keywords":["ruby,ruby","on","rails,configuration,monilith,microservice"],"mainEntityOfPage":"true","wordCount":"5274"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://zzet.org/","name":"","position":1},{"@type":"ListItem","item":"https://zzet.org/archive/","name":"","position":2},{"@type":"ListItem","name":"Project Configuration. Part 1. Railsclub Intro.","position":3}]}</script><meta name=author content="Andrey Kumanyaev"><link href=https://github.com/zzet rel=me><link href=https://x.com/zzetorg rel=me><link href=https://www.reddit.com/user/zzet/ rel=me><link href=https://www.linkedin.com/in/andrey-kumanyaev/ rel=me><script async src="https://www.googletagmanager.com/gtag/js?id=G-VGXR3BQCTQ"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VGXR3BQCTQ")}</script></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>Andrey Kumanyaev</a></div><ul class="flex list-none flex-col text-end sm:flex-row"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/about/ title=About><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">About</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/posts/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Blog</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=https://github.com/zzet title target=_blank><span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=https://x.com/zzetorg title target=_blank><span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="hidden inline"><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=https://zzet.org/></a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=https://zzet.org/archive/>archive</a><span class="px-1 text-primary-500">/</span></li><li class="hidden inline"><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/>Project configuration. Part 1. Railsclub intro.</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Project configuration. Part 1. Railsclub intro.</h1><div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2017-10-29 00:00:00 +0000 UTC">29 October 2017</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">25 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/zzet.github.com/content/archive/2017-10-29-project-configuration-railsclub-intro.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M490.3 40.4c21.9 21.87 21.9 57.33.0 79.2l-30 30.1-98-97.98 30.1-30.06C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7 339.7 74.34l98 97.96L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2l-88.8 29.6C150.1 385.6 141.5 383.4 135 376.1 128.6 370.5 126.4 361 129.2 352.4l29.6-88.8C161.6 255.3 166.2 247.8 172.4 241.7v0zM192 63.1c17.7.0 32 15.23 32 32 0 18.6-14.3 32-32 32H96c-17.67.0-32 15.2-32 32V416c0 17.7 14.33 32 32 32H352c17.7.0 32-14.3 32-32V319.1c0-16.8 14.3-32 32-32s32 15.2 32 32V416c0 53-43 96-96 96H96c-53.02.0-96-43-96-96V159.1c0-53 42.98-96 96-96h96z"/></svg></span></a></span></div></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="min-h-0 min-w-0 max-w-prose grow"><p>Смените язык внизу станицы для доступа к оригинальной статье или перейдите по <a href=https://zzet.org/ru/archive/2017-10-29-project-configuration-railsclub-intro/ target=_blank rel=noreferrer>ссылке</a></p><p>This article was originally a transcript of a talk given at the Railsclub 2017 conference. Minor corrections have been made to the text following the conference.</p><p>In the process of reading, you will understand why it makes no sense to describe every detail immediately. I do not absolve myself of responsibility for providing the information of interest. You can write in the comments what questions have arisen and what should be explained in more detail. This will serve as a trigger for detailed publications.</p><p>Let&rsquo;s go.</p><p>Today I want to talk about a topic that might seem old, hackneyed, and uninteresting to those around us. But actually, that&rsquo;s not the case. As they say, everything new is well-forgotten old, especially if the old <strong>needs</strong> to be updated. I think you&rsquo;ve heard that all talks are divided into 2 types: bragging or confessing. Today I will be doing the second (probably).</p><p>While preparing for the talk, I thought about the best way to start the narrative&mldr; I came up with a tearful story about my experience fighting castles in the air, found some scary pictures&mldr; And then I went to Wikipedia and&mldr; found the answer to the question I want to cover.</p><blockquote><p>Software configuration is the collection of program settings defined by the user, as well as the process of changing these settings in accordance with the user&rsquo;s needs.</p></blockquote><p>The problem is that the majority only looks at the first part of this definition, and (very often) do not take the second part into account. Of course, the problem isn&rsquo;t just that—we will look at key aspects—but this specific question prompted me to reconsider my views on project configuration and develop a new approach. And the question is not just about how to update configuration in the literal sense. No, I won&rsquo;t talk about how you need to press keys to generate code. I want to touch upon the problem of introducing changes to configuration, delivering these changes to production, and working in different environments with the same code. That is what I will talk to you about today. And yes, the conversation will be in the context of Ruby, of course (but it can be translated to other languages and technologies) :)</p><p>I&rsquo;ll start with a small lyrical digression. Many people here say that Ruby is dead, that it isn&rsquo;t developing, that the world is decay, and it&rsquo;s time to bail. It just so happened that over the last 3 years, I&rsquo;ve seen a number of completely different projects. Different not only in terms of domain but also in terms of architecture. There were monoliths, semi-monoliths, semi-semi-monoliths, and projects based on microservice architecture. And projects on MRI, on JRuby, and mixtures with other languages. A zoo, in a word.</p><p>So, in each of these projects, different approaches to the configuration of these projects were applied. The approaches were different, and the problems were also different. But all these <em>problems</em> boiled down to the same word: <strong>configuration</strong>.</p><p>It happened that while participating in one project, I simply started to—as they say—burn out. The competence and professionalism of the guys on the team raised no questions, but the approaches and certain decisions&mldr; for a long time, I couldn&rsquo;t understand why exactly these decisions were made, but I saw that they were leading nowhere. And then I realized. The problem was on the surface: <strong>We preach what we are used to</strong>. Therefore, I will consider the issue of <strong>Habit</strong> first and foremost.</p><p>When we spoke with the Railsclub conference organizers about this talk, I sent them this <a href="https://www.youtube.com/watch?v=FeCXooh8AXE" target=_blank rel=noreferrer>video</a>. Enough time has passed since then for me to find politically correct words, systematize my hatred, and calmly lay everything out.</p><h1 id=convention-over-configuration class="relative group">Convention over Configuration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#convention-over-configuration aria-label=Anchor>#</a></span></h1><p>The funniest thing in this story is that the Rails ecosystem is built on conventions, yet the question of configuration specifically does not obey this rule, and in this matter, it&rsquo;s a free-for-all. Yes, it&rsquo;s just such a paradox. We have conventions so there isn&rsquo;t a ton of configuration, but you still can&rsquo;t escape configuration.</p><p>If anyone doesn&rsquo;t know, Convention over Configuration (CoC) is a design principle for frameworks and libraries intended to reduce the amount of required configuration without losing flexibility. In a strict form, this principle can be expressed as follows: an aspect of a software system needs configuration if and only if that aspect DOES NOT satisfy a certain specification. The principle works when it comes to mapping classes to certain resources (database tables, events, file system resources). According to the principle, if a class matches the naming convention, then it does not need additional configuration. In this context, the name of the principle indicates the primacy of the convention over the configuration.</p><p>A classic example of the CoC principle is Hibernate. In Hibernate, object-relational mapping rules can be described using XML files:</p><p>XML</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p><code>&lt;class name="Tag" table="tag"> &lt;property name="Name" column="name"/> &lt;property name="Value" column="value"/> &lt;property name="Value2" column="value2"/> &lt;property name="Value3" column="value3"/> &lt;/class></code></p><p>As you can see, there are repetitions of class properties and table columns. If we introduce a convention that by default table columns must be named the same as the property, we can omit part of the configuration:</p><p>XML</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p><code>&lt;class name="Tag"> &lt;property name="Name"/> &lt;property name="Value"/> &lt;property name="Value2"/> &lt;property name="Value3"/> &lt;/class></code></p><p>However, if some property needs to be saved in a column with a different name, this will have to be specified explicitly. This is the essence of the principle.</p><p>The CoC principle finds its greatest application in the Ruby on Rails environment. This is understandable in principle, given that RoR is oriented towards rapid development, and CoC allows configuration to be reduced to a minimum.</p><p>And essentially, this is correct, but! But this in no way removes responsibility from configuration issues. It is incorrect to think that all problems have already been solved for you by other people, and if something in your work goes beyond the guides, then you can write &ldquo;a little bit of garbage code.&rdquo;</p><h1 id=monolith---not-a-monolith class="relative group">Monolith - Not a Monolith <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#monolith---not-a-monolith aria-label=Anchor>#</a></span></h1><p>Although, I started off on the wrong foot. First, I should ask, who among you works on a monolith project?</p><p>For these people, most likely, the first part of the article is not interesting, because everything is much simpler (no, not simple, there are problems) when you have a monolithic application. What do we have: all changes are stored in one place, they are much easier to synchronize. Very often, no <em>serious</em> problems arise with monoliths. And if conflicts do arise in terms of configuration—they don&rsquo;t cause much pain. A few abstract crutches, a little terror towards DevOps, and that&rsquo;s it, most problems are solved. But when it starts to split into small services (I advise not to rush into this if you don&rsquo;t know what you are getting into)—here many questions arise regarding how to maintain consistency, including in configuration. After all, everyone understands perfectly well that the more independent components there are in a system, the harder they are to synchronize. And then the rule &ldquo;if it works, don&rsquo;t touch it&rdquo; kicks in, which we will talk about later :).</p><p>Therefore, I have several goals today:</p><ol><li>To grumble about how people shoot themselves in the foot and consider it normal.</li><li>To sow a note of doubt among some people regarding the fact that everything is fine and nothing needs to be done/changed.</li><li>To shed light on the problem of microservices in Ruby (and not only in Ruby, but we are at Railsclub, so Ruby).</li></ol><h1 id=existing-approaches class="relative group">Existing Approaches <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#existing-approaches aria-label=Anchor>#</a></span></h1><p>And for this, we need to look at a retrospective; there&rsquo;s no way around it. Does everyone remember how approaches to configuration evolved? By the way, did everyone notice that I haven&rsquo;t asked anyone yet what they consider to be <em>configuration</em>?</p><h2 id=constants class="relative group">Constants <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#constants aria-label=Anchor>#</a></span></h2><p>The simplest, fastest, and in some cases, indispensable option. Just recall how a ruby gem version is described.</p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`# lib/persey/version.rb
module Persey
VERSION = &ldquo;0.0.11&rdquo;
end</p><h1 id=perseygemspec class="relative group">persey.gemspec <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#perseygemspec aria-label=Anchor>#</a></span></h1><h1 id=heading class="relative group">&mldr; <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#heading aria-label=Anchor>#</a></span></h1><p>Gem::Specification.new do |spec|</p><h1 id=heading-1 class="relative group">&mldr; <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#heading-1 aria-label=Anchor>#</a></span></h1><p>spec.version = Persey::VERSION</p><h1 id=heading-2 class="relative group">&mldr; <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#heading-2 aria-label=Anchor>#</a></span></h1><p>end`</p><p>I see the approach using constants as a tool for configuration very often, especially in various libraries.</p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`# <a href=https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/gem_version.rb target=_blank rel=noreferrer>https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/gem_version.rb</a>
module ActionCable
def self.gem_version
Gem::Version.new VERSION::STRING
end</p><p>module VERSION
MAJOR = 5
MINOR = 2
TINY = 0
PRE = &ldquo;alpha&rdquo;</p><pre><code>STRING = [MAJOR, MINOR, TINY, PRE].compact.join(&quot;.&quot;)
</code></pre><p>end
end`</p><p>Or this:</p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`# <a href=https://github.com/rails/rails/blob/master/actioncable/lib/action_cable.rb target=_blank rel=noreferrer>https://github.com/rails/rails/blob/master/actioncable/lib/action_cable.rb</a>
module ActionCable
extend ActiveSupport::Autoload</p><p>INTERNAL = {
message_types: {
welcome: &ldquo;welcome&rdquo;.freeze,
ping: &ldquo;ping&rdquo;.freeze,
confirmation: &ldquo;confirm_subscription&rdquo;.freeze,
rejection: &ldquo;reject_subscription&rdquo;.freeze
},
default_mount_path: &ldquo;/cable&rdquo;.freeze,
protocols: [
&ldquo;actioncable-v1-json&rdquo;.freeze,
&ldquo;actioncable-unsupported&rdquo;.freeze
].freeze
}</p><h1 id=heading-3 class="relative group">&mldr; <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#heading-3 aria-label=Anchor>#</a></span></h1><p>end</p><h1 class="relative group"><a href=https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/web_socket.rb target=_blank rel=noreferrer>https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/web_socket.rb</a> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>module ActionCable
module Connection
# Wrap the real socket to minimize the externally-presented API
class WebSocket # :nodoc:
def initialize(env,
event_target,
event_loop,
protocols: ActionCable::INTERNAL[:protocols]
)
# &mldr;
end
# &mldr;
end
end
end`</p><p>Projects of a larger scale are no exception (unfortunately). And if, in the examples above, this can somehow be called constants, in reality, developers get so carried away that they write whatever they want into constants.</p><p>Once I was at an interview at a company. During the interview, we touched on the topic &ldquo;What do you think, can constants be used to store configuration?&rdquo;. I answered unequivocally no, that it is bad. Spoiler (this is exactly why my candidacy was rejected, for which I thank them very much).</p><p>What arguments were given in favor of using constants?</p><ol><li>Constants can be accessed from everywhere (if the file with constants is loaded).</li><li>Constants help improve code readability. Magic numbers and strings disappear.</li><li>Easy to search through the code (you search for the constant name, not a magic number).</li><li>Cannot be modified at runtime.</li></ol><p>Well, in principle, everything is true (almost). But there are counterarguments too.</p><ol><li>No one keeps constants in one place. They are always smeared across the code. To reuse a particular constant, you need to know where it lies (in which file/module/class). And no one wants to memorize this (moreover, no one needs to). As a result, everything leads to developers starting to duplicate these configuration parameters. As soon as you need to change a particular magic string, the game of &ldquo;guess what the colleague named the constant&rdquo; begins in order to find it in the code. Is this problem curable? Yes, more discipline, concentration, and attention. But why all this?</li><li>The line between a constant value and a configuration parameter begins to blur. People start stuffing everything that comes to mind into constants.</li></ol><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p><code>RETRIES_COUNT = 10 API_HOST = 'https://your.domain.com'</code></p><ol><li>Different environments turn life into hell. In the test environment one value is needed, on staging another, in production a third, and the project might not be limited to three or four environments.</li></ol><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`RETRIES_COUNT = case Rails.env
when &rsquo;test'
2
when &lsquo;development&rsquo;
5
when &lsquo;staging&rsquo;
10
else
50
end</p><p>API_HOST = case Rails.env
when &rsquo;test'
&lsquo;<a href=https://fake.domain.com target=_blank rel=noreferrer>https://fake.domain.com</a>&rsquo;
when &lsquo;development&rsquo;
&lsquo;https://loalhost:3000&rsquo;
when &lsquo;staging&rsquo;
&lsquo;<a href=https://your-staging.domain.com target=_blank rel=noreferrer>https://your-staging.domain.com</a>&rsquo;
else
&lsquo;<a href=https://your-production.domain.com target=_blank rel=noreferrer>https://your-production.domain.com</a>&rsquo;
end`</p><ol><li>Do not change? Yeah, right.</li></ol><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`class SomeClass
CONSTANT_STRING = &ldquo;string&rdquo;
CONSTANT_NUMBER = 1
CONSTANT_ARRAY = [1, 2, 3]
CONSTANT_HASH = { a: :b }
CONSTANT_HELL = {
a: CONSTANT_HASH,
b: CONSTANT_ARRAY,
c: {
d: :e,
f: [1, 2, 3]
}
}
end</p><p>[1] pry(main)> SomeClass::CONSTANT_STRING
=> &ldquo;string&rdquo;
[2] pry(main)> SomeClass::CONSTANT_STRING &#171; &lsquo;smth&rsquo;
=> &ldquo;stringsmth&rdquo;
[3] pry(main)> SomeClass::CONSTANT_STRING
=> &ldquo;stringsmth&rdquo;`</p><p>Everyone knows that everything is simple here, use <code>.freeze</code> and then no values can be changed.</p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`class SomeClass
CONSTANT_STRING = &ldquo;string&rdquo;.freeze
CONSTANT_NUMBER = 1.freeze
CONSTANT_ARRAY = [1, 2, 3].freeze
CONSTANT_HASH = { a: :b }.freeze
CONSTANT_HELL = {
a: CONSTANT_HASH,
b: CONSTANT_ARRAY,
c: {
d: :e,
f: [1, 2, 3]
}
}.freeze
end</p><p>[1] pry(main)> SomeClass::CONSTANT_STRING
=> &ldquo;string&rdquo;
[2] pry(main)> SomeClass::CONSTANT_STRING &#171; &lsquo;smth&rsquo;
RuntimeError: can&rsquo;t modify frozen String</p><p>[3] pry(main)> SomeClass::CONSTANT_HELL[:a] = 123
RuntimeError: can&rsquo;t modify frozen Hash</p><p>[4] pry(main)> SomeClass::CONSTANT_HELL
=> {:a=>{:a=>:b}, :b=>[1, 2, 3], :c=>{:d=>:e, :f=>[1, 2, 3]}}
[5] pry(main)> SomeClass::CONSTANT_HELL[:c][:d] = 123
=> 123
[6] pry(main)> SomeClass::CONSTANT_HELL
=> {:a=>{:a=>:b}, :b=>[1, 2, 3], :c=>{:d=>123, :f=>[1, 2, 3]}}`</p><p>Except that freeze does not &ldquo;freeze&rdquo; nested objects, and one can very easily run into such a situation.</p><p>But credit where credit is due: redefining a constant won&rsquo;t work. This is perhaps the only thing they are good for.</p><p>If anyone is interested in asking about how this works inside the Ruby machine—we&rsquo;ll talk about it on the sidelines, so let&rsquo;s move on.</p><p>Yes, if someone wants to say that environment variables can be used at the same time—yes, they can. But that also doesn&rsquo;t work :)</p><h2 id=config-file class="relative group">Config file <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#config-file aria-label=Anchor>#</a></span></h2><p>The second most popular approach is to put all parameters into YAML files, which will then be read and the resulting hash will be used as the configuration storage object.</p><p>There are undoubtedly pluses to this approach. As well as minuses, for that matter&mldr;</p><h3 id=pros class="relative group">Pros: <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pros aria-label=Anchor>#</a></span></h3><ol><li>Finally, configuration has started accumulating in one place.</li><li>YAML files allow you to elegantly describe configuration, separate by environments, remove duplication.</li></ol><p>YAML</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`common: &amp;common
adapter: postgresql
host: &lt;%= ENV.fetch(&lsquo;DB_HOST&rsquo;) %>
database: &lt;%= ENV.fetch(&lsquo;DB_NAME&rsquo;) %>
username: &lt;%= ENV.fetch(&lsquo;DB_USERNAME&rsquo;) %>
password: &lt;%= ENV.fetch(&lsquo;DB_PASSWORD&rsquo;) %>
encoding: unicode
pool: &lt;%= ENV.fetch(&lsquo;DB_POOL&rsquo;) %></p><p>development:
&#171;: *common</p><p>test:
&#171;: *common</p><p>staging:
&#171;: *common
port: 5432`</p><ol><li>You can use environment variables (the option of running the read file through the ERB preprocessor is used universally).</li><li>Separation of configs by domain areas is very good. I love it when everything is on the shelves.</li></ol><h3 id=cons class="relative group">Cons: <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cons aria-label=Anchor>#</a></span></h3><ol><li>You depend on the internal implementation of a particular gem (especially regarding the use of environment variables). For example, the database config goes through ERB preprocessing. But what happened to <code>cable.yml</code>? Why was it deprived?</li><li>You cannot re-apply the same configuration parameter between different files, as they are autonomous. An exception, of course, can be said right away—sharing these data through environment variables. Who among you has done this in a large project where there are quite a lot of such environment variables?</li></ol><p>Bash</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p><code>$ grep -R ENV config app lib | wc -l 458</code></p><ol><li>You cannot reuse parts of the config within the config itself (well, strictly speaking, this isn&rsquo;t true, what is meant is that you can&rsquo;t do it elegantly).</li><li>It is difficult to maintain changes if the file structure changes.</li><li>And the biggest problem—it is difficult to track changes in these configuration files.</li></ol><p>I encountered the last point quite a long time ago when contributing to Gitlab. There were 3 main problems:</p><ol><li>Synchronization of file changes (source files were supplied as <code>config.yml.example</code>), which had to be copied and rewritten. As soon as new parameters appear in <code>config.yml.example</code> that you, due to some circumstances, did not notice, problems can begin.</li><li>Support for changes in the files themselves (backward compatibility support).</li><li>Duplication of configuration parameters (there was gitlab-shell and gitlab itself. Both parts had to know which path the repositories lay on. If you had to change one parameter—you had to remember the other. But wait, this is one product, what is this nonsense?)</li></ol><p>How were these problems solved? They weren&rsquo;t. Well, we solved them internally ;), but <code>Undev</code> is no more and no one remembers that anymore. I, at least, hope so.</p><p>Well, at the moment, this approach leads in the community of rails (and not only) developers.</p><h2 id=dsl class="relative group">DSL <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#dsl aria-label=Anchor>#</a></span></h2><p>This variant should probably have been mentioned earlier, as it appeared and took root earlier than the variant with configuration files. But I put it as the next item because it can still be used in a more flexible variant.</p><p>I think everyone knows about</p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`Rails.application.configure do</p><h1 id=heading-4 class="relative group">&mldr; <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#heading-4 aria-label=Anchor>#</a></span></h1><p>end`</p><p>So this variant is exactly from this opera.</p><p>Pros:</p><ol><li>The config reads very well.</li><li>Config == code. Possibilities for describing configuration increase.</li><li>Can be tested (!!!). Yes, the config can be tested and one can be sure that everything is fine with it. Except nobody does this. Here, of course, one can argue about what needs to be tested and what does not.</li><li>All the pros from the <strong>Config object</strong>.</li></ol><p>I particularly like the <code>Dry-configurable</code> variant (I am generally a fan of Dry).</p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`class App
extend Dry::Configurable</p><h1 id=pass-a-block-for-nested-configuration-works-to-any-depth class="relative group">Pass a block for nested configuration (works to any depth) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pass-a-block-for-nested-configuration-works-to-any-depth aria-label=Anchor>#</a></span></h1><p>setting :database do
# Can pass a default value
setting :dsn, &lsquo;sqlite:memory&rsquo;
end</p><h1 id=defaults-to-nil-if-no-default-value-is-given class="relative group">Defaults to nil if no default value is given <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#defaults-to-nil-if-no-default-value-is-given aria-label=Anchor>#</a></span></h1><p>setting :adapter</p><h1 id=pre-process-values class="relative group">Pre-process values <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pre-process-values aria-label=Anchor>#</a></span></h1><p>setting(:path, &rsquo;test&rsquo;) { |value| Pathname(value) }</p><h1 id=passing-the-reader-option-as-true-will-create-attr_reader-method-for-the-class class="relative group">Passing the reader option as true will create attr_reader method for the class <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#passing-the-reader-option-as-true-will-create-attr_reader-method-for-the-class aria-label=Anchor>#</a></span></h1><p>setting :pool, 5, reader: true</p><h1 id=passing-the-reader-attributes-works-with-nested-configuration class="relative group">Passing the reader attributes works with nested configuration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#passing-the-reader-attributes-works-with-nested-configuration aria-label=Anchor>#</a></span></h1><p>setting :uploader, reader: true do
setting :bucket, &lsquo;dev&rsquo;
end
end</p><p>App.config.database.dsn</p><h1 id=-sqlitememory class="relative group">=> &ldquo;sqlite:memory&rdquo; <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#-sqlitememory aria-label=Anchor>#</a></span></h1><p>App.configure do |config|
config.database.dsn = &lsquo;jdbc:sqlite:memory&rsquo;
end</p><p>App.config.database.dsn</p><h1 id=-jdbcsqlitememory class="relative group">=> &ldquo;jdbc:sqlite:memory&rdquo; <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#-jdbcsqlitememory aria-label=Anchor>#</a></span></h1><p>App.config.adapter</p><h1 id=-nil class="relative group">=> nil <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#-nil aria-label=Anchor>#</a></span></h1><p>App.config.path</p><h1 id=- class="relative group">=> #<a href=Pathname:test>Pathname:test</a> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#- aria-label=Anchor>#</a></span></h1><p>App.pool</p><h1 id=-5 class="relative group">=> 5 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#-5 aria-label=Anchor>#</a></span></h1><p>App.uploader.bucket</p><h1 id=-dev class="relative group">=> &lsquo;dev&rsquo;` <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#-dev aria-label=Anchor>#</a></span></h1><h2 id=singleton class="relative group">Singleton <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#singleton aria-label=Anchor>#</a></span></h2><p>Also, a similar variant of storing configuration has taken root quite firmly in the Ruby world (including in the Rails code itself).</p><p>The essence of this approach boils down to the following: configuration data is read from some source (sources) and saved in one object.</p><p>The pros and cons depend on where and how this data is taken.</p><h2 id=db class="relative group">DB <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#db aria-label=Anchor>#</a></span></h2><p>I always remember the times working in a web studio, churning out sites on CMSs, when I see such an approach. When there is a table in the database, configuration parameters are stored there as key => value, and the developer runs to this database from the code to read certain values. Actually, there is nothing disgustingly bad about this. This is one way to share configuration that can change at any moment. And it doesn&rsquo;t matter where it will be (PostgreSQL, Redis, etc.).</p><p>Problems:</p><ul><li>Very fragile system (lives only if the key cannot be deleted).</li><li>Load on the database can be very high.</li><li>Parasitic traffic.</li><li>Drops in application speed.</li></ul><p>Pros:</p><ul><li>Configuration of individual system components can be changed on the fly.</li><li>Sharing configuration between different services out of the box.</li></ul><h1 id=problems-that-the-majority-ignore class="relative group">Problems that the majority ignore <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#problems-that-the-majority-ignore aria-label=Anchor>#</a></span></h1><h2 id=many-configs class="relative group">Many configs <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#many-configs aria-label=Anchor>#</a></span></h2><p>Obviously, the more complex the application, the more libraries are used. And often, each library asks for its own configuration file. Speaking in the context of Rails, this leads to 2 directories starting to swell from the number of such files:</p><p><code>config</code></p><p><code>config/initializers</code></p><p>The problem here, as you understand, is not in the number of files, but in the number of variables/modules/classes that store configuration values.</p><p>One way or another, the growth in the number of such entities leads to the appearance of additional abstractions in order to observe DRY principles, which leads to high code coupling and less understanding of what is happening. And an additional problem begins to manifest: how to ensure configuration consistency. The problem of maintenance. However, this problem is easily shifted onto the shoulders of other people (for example, DevOps, we talked about how all these problems can be solved using environment variables, although this is also nonsense, at least because eventually, it becomes impossible to invent and combine a large number of variables).</p><h2 id=different-file-formats class="relative group">Different file formats <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#different-file-formats aria-label=Anchor>#</a></span></h2><p>Not so many teams and projects encounter such a situation, but it happens and it is worth mentioning. How many people use in their solutions not only ruby libraries but specific software that has a very concrete configuration?</p><p>What if there are small services that have their own configs? You still need (not always) to take into account parameters from these configs. Copy-paste? Pass through environment variables? And what to do if the service is launched by a supervisor at system startup? Juggle environment variables? And if the service cannot read these environment variables (can only read from a file)? Rewrite the service just so it can do this? And if you don&rsquo;t know the programming language or the software is proprietary?</p><p>All these questions ultimately boil down to the fact that you just need to duplicate important parameters. Just duplicate, instead of reusing. Yes, I do not argue, this question can also be solved with the help of DevOps. And even then, not always. In general, sometimes a situation arises where you just need to read one more config and have access to it from the application code.</p><h2 id=dynamic-configuration--using-configuration-within-configuration class="relative group">Dynamic configuration & using configuration within configuration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#dynamic-configuration--using-configuration-within-configuration aria-label=Anchor>#</a></span></h2><p>How often do you need to assemble 1 parameter from several configuration parameters?</p><p>You don&rsquo;t need to look far—the database connection string.</p><p>Let&rsquo;s recall the database config.</p><p>YAML</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`common: &amp;common
adapter: postgresql
host: &lt;%= ENV.fetch(&lsquo;DB_HOST&rsquo;) %>
database: &lt;%= ENV.fetch(&lsquo;DB_NAME&rsquo;) %>
username: &lt;%= ENV.fetch(&lsquo;DB_USERNAME&rsquo;) %>
password: &lt;%= ENV.fetch(&lsquo;DB_PASSWORD&rsquo;) %>
encoding: unicode
pool: &lt;%= ENV.fetch(&lsquo;DB_POOL&rsquo;) %></p><p>development:
&#171;: *common</p><p>test:
&#171;: *common</p><p>staging:
&#171;: *common
port: 5432`</p><p>And in the application, you need to use not only data in this format but also the connection string as a single string. What to do in this case?</p><p>YAML</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p><code>common: &amp;common adapter: postgresql host: &lt;%= ENV.fetch('DB_HOST') %> database: &lt;%= ENV.fetch('DB_NAME') %> username: &lt;%= ENV.fetch('DB_NAME') %> password: &lt;%= ENV.fetch('DB_PASSWORD') %> encoding: unicode pool: &lt;%= ENV.fetch('DB_POOL') %> dsn: postgres://&lt;%= ENV.fetch('DB_NAME') %>:&lt;%= ENV.fetch('DB_PASSWORD') %>@&lt;%= ENV.fetch('DB_HOST') %>:&lt;%= ENV.fetch('DB_PORT') %>/&lt;%= ENV.fetch('DB_NAME') %>?pool=&lt;%= ENV.fetch('DB_POOL') %></code></p><p>Does no one see a problem with this? Actually, there is no problem, there is an annoying nuisance in the form of the need to control 2 places where the environment variable is used instead of one.</p><p>But what if it&rsquo;s the other way around, extracting several attributes from 1 parameter? You have a <code>dsn</code> at the input and need to break it into separate parameters (for example, the connection string to AWS RDS DB)?</p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p><code>common: &amp;common dsn: &lt;%= ENV.fetch(‘DB_DSN’) %> adapter: ??? host: ??? database: ??? username: ??? password: ??? encoding: unicode pool: ???</code></p><p>Or supplement 1 parameter with additional data (for example, several databases in Redis)? Here, the hemorrhoid increases a bit more.</p><p>I don&rsquo;t particularly see the point in clogging the environment variable scope for every sneeze. It is enough to demand support for such behavior/features from the part of the project responsible for configuration.</p><h2 id=combining-different-types-of-configuration class="relative group">Combining different types of configuration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#combining-different-types-of-configuration aria-label=Anchor>#</a></span></h2><p>And what to do when you have configuration described using DSL, configuration lying in the database, files with configs, configs passed through environment variables? Convert everything to one format? For example, use only YAML files or only DSL? Actually, this is a correct thought and I would choose the second option. At least in this case, you can use <code>lambda</code> to include one config in the second.</p><h2 id=reusing-configuration-in-parent-projects-config-registry class="relative group">Reusing configuration in parent projects (config registry) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#reusing-configuration-in-parent-projects-config-registry aria-label=Anchor>#</a></span></h2><p>This is also an interesting moment. Let&rsquo;s imagine a situation: you are writing a small application that takes data from an API, does something with it, writes the result to a file, and uploads it to an AWS S3 bucket. In this abstract task, 3 components can be distinguished:</p><ol><li>Call to API.</li><li>Performing the operation.</li><li>Uploading the file.</li></ol><p>Obviously, each of these parts (at least 2) will require credentials. And most likely, they will lie in 2 files side by side and the first and third components will read them perfectly and everything will work. Now the question: what is the probability that in the second component you will need to take into account configuration parameters from 1 and 3?</p><p>Here the following questions arise:</p><ol><li>Are you using a third-party solution?</li><li>Access the configuration object?</li><li>What if the configuration is encapsulated and there is no public access to it?</li></ol><p>Of course, this is Ruby, you can call private methods and reach the most spicy places, risking that your code will break when the internal interface of the library changes.</p><p>Or it is simpler to combine these 2 configs (make a proxy interface to them).</p><p>And now let&rsquo;s imagine that we have some description of models that your services can work with, and you extracted them into a separate gem. One way or another, this gem will have configuration, and you may need access to the parameters of some keys from your service. How to proceed in this case? Duplicate configs? Or reuse the configuration object from the parent class?</p><p>And if you connected another 1 library, and it has its own config? Access this config directly or also pass access to it through your config? If you choose the first option, doesn&rsquo;t it seem to you that this is similar to the story with smearing constants? And what about the rule of one level of abstraction? And how to guarantee that your configuration interface will be immutable (replacing the backend does not call for changing the code)?</p><h2 id=reloading-configs class="relative group">Reloading configs <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#reloading-configs aria-label=Anchor>#</a></span></h2><h3 id=app-restart-vs-configuration-reload class="relative group">App restart vs configuration reload <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#app-restart-vs-configuration-reload aria-label=Anchor>#</a></span></h3><p>Let&rsquo;s return briefly to monoliths. When you have an application executed as a monolith, it has both pros and cons in terms of the ability to use such an approach to configuration updates. It is worth starting with the fact that there is no particular practical sense in reloading configuration without restarting the application. At least because changes in the project itself (usually) happen quite quickly and the probability that a configuration change might come with a code change is very high. And changing configuration in this case is equivalent to changing code, due to the fact that code coupling is very high.</p><p>The situation changes slightly when the monolith is launched not quite as a monolith. Despite the fact that the code lies in one place, all these components are launched separately. For example, the API separately (and the API itself can also be separated, for example by versions), the web part of the personal account separately, public controllers separately, background tasks of <code>critical</code> level separately, and so on.</p><p>And everything changes radically when instead of 1 large application you get many small ones (or as people like to call it - microservices).</p><p>In the last 2 cases, the question becomes legitimate:</p><p><strong>Does it make practical sense to restart all services if the code in them has not changed, but changes have occurred in the configuration?</strong></p><p>Of course, this question has many other parameters:</p><ul><li>What is the cost of restarting the service?</li><li>Is it necessary to restart the service?</li></ul><p>Obviously, the smaller the service, the lighter its restart. And the downtime here can be quite small. But what does this restart represent? <strong>Graceful restart</strong> or <strong>SIGKILL</strong> + <strong>SIGEXIT</strong>? If you have the second option—restarting all services when necessary to reload configuration becomes a dangerous venture. At least because some service might:</p><ol><li>Be performing heavy operations.</li><li>Contain a cache that needs to be warmed up after restart.</li><li>Premature termination of work may affect data consistency.</li><li>Very frequent restarts can block the flow.</li></ol><p>These points alone are enough to doubt the usefulness of restarting all services when changing one.</p><p>The desire to keep all services running &ldquo;on the freshest code&rdquo; is inherent in many developers. Sometimes to the point of fanaticism. Hmm. Do all of you update gems every day (to guarantee that the freshest version of the gem is used)? Then why restart the service if no changes have occurred in it (or changes in a neighboring service do not affect changes in a specific one)?</p><p>Thus, for me, the priority question is: <strong>Do we need to restart it?</strong> and <strong>Do changes in configuration/code affect the work of the application itself?</strong></p><p>Let&rsquo;s analyze the second moment in more detail:</p><p>It is considered good practice to have isolated storage for each microservice. By storage, one can understand, for example, a database. And all data is passed between these services over the network. But in practice, this is practically unattainable (at least immediately). One way or another, at the very beginning you will have, for example, a database shared between these services. Not necessarily between all of them. Or you need to use separate storage for communications (use the result of one service&rsquo;s work in another, while the volume of data can be quite large (We had a case where several million rows from one service needed to be transferred to another). In such a case, it turns out that a change, for example, in part of the configuration (information about the location of such storage) does not affect all system services, but only a limited number of these services, correspondingly, these changes should not affect others.</p><p>In that case, a possibility is needed to inform the application that the configuration is outdated and needs to be updated. How to do this correctly?</p><h3 id=api-interface-for-updating-configuration class="relative group">API interface for updating configuration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#api-interface-for-updating-configuration aria-label=Anchor>#</a></span></h3><p>For some reason, it is most often proposed to implement an API on the side of each service that can be knocked on to report that some change has occurred. Well&mldr; So-so solution. It feels kinda lazy to <strong>implement</strong> such an interface for each service independently.</p><h3 id=sighup-to-support-configuration-reload class="relative group">SIGHUP to support configuration reload <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#sighup-to-support-configuration-reload aria-label=Anchor>#</a></span></h3><p>The idea boils down to sending a <strong>SIGHUP</strong> signal to the service so that it updates the configuration (re-reads it). Such an approach still has wide application in the Ruby world. But this is logical, as everyone is used to restarting the application if something has changed.</p><h3 id=configuration-conflict-problem-configuration-change-at-runtime class="relative group">Configuration conflict problem (configuration change at runtime) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#configuration-conflict-problem-configuration-change-at-runtime aria-label=Anchor>#</a></span></h3><p>Let&rsquo;s imagine such a situation: We know how to reload configuration in real-time. In such a case, we can get a situation where the code was launched on one configuration, an update occurred, and it started working based on another configuration. On one hand, this might not be scary, on the other&mldr; it might be useful.</p><p>For example, you were writing part of the data to one place, then information arrived that you need to write to another place and you decided to switch. This looks somewhat not very good. Part of the data in one place, part of the data in another, and it is unknown where and how much.</p><p>Or you had a limit on string length. It was <code>1000</code> characters, it became <code>800</code>. Part of the generated strings will correspond to the required result, part will not. Is this good or bad? I cannot say unequivocally. For us, similar situations were both useful and harmful. But it is better when the result corresponds to a specific criterion. Either all <code>1000</code> characters, or all <code>800</code>.</p><p>Accordingly, it is better to keep this under control somehow. How many people use the <code>config object</code> pattern in their work?</p><h2 id=using-the-config-object-approach class="relative group">Using the config object approach <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#using-the-config-object-approach aria-label=Anchor>#</a></span></h2><p>We pass a configuration object into the class/method and use this snapshot. During the operation execution, the config may change, the snapshot remains unchanged. If the configuration changes were critical—execution will fail and the service will recover with the new configuration, continue work, and everything will be fine.</p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`def generate_ad_headline(headline_parts: [])
headline = headline_parts.each_pair.each_with_object({}) do |(ad_id, parts), acc|
acc[ad_id] = parts.each_with_object("") do |part, result_headline|
if (result_headline + part).size &lt; YourApp.config.ads.headline.max_size
result_headline &#171; part
end
end
end
end</p><p>def generate_ad_headline(headline_parts: [], config_object: YourApp.config.ads.headline)
headline = headline_parts.each_pair.each_with_object({}) do |(ad_id, parts), acc|
acc[ad_id] = parts.each_with_object("") do |part, result_headline|
if (result_headline + part).size &lt; config.max_size
result_headline &#171; part
end
end
end
end`</p><h2 id=pubsub-configuration-update-model class="relative group">pub/sub configuration update model <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pubsub-configuration-update-model aria-label=Anchor>#</a></span></h2><p>Consul config</p><p>etcd</p><p>similar services</p><p>Problem: you have several services</p><h1 id=project-configuration-is-not-just-magic-strings class="relative group">Project configuration is not just magic strings <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#project-configuration-is-not-just-magic-strings aria-label=Anchor>#</a></span></h1><p>Flexible code with a minimal set of changes.</p><h2 id=service-locators-as-part-of-configuration-di class="relative group">Service locators as part of configuration (DI) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#service-locators-as-part-of-configuration-di aria-label=Anchor>#</a></span></h2><p>Do not tie yourself to a specific service (gem interface) or class communicating with the outside world directly. Use service locators.</p><p><strong>Implementation example using Dry-container</strong></p><p>Ruby</p><h1 class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=# aria-label=Anchor>#</a></span></h1><p>`class ServiceLocator
class Container
include Dry::Container::Mixin
end</p><p>class &#171; self
attr_reader :instance</p><pre><code>def configure
  container = Container.new
  yield(container)
  @instance = new(Rails.application, container)
  freeze
end

def [](name)
  instance[name]
end
</code></pre><p>end</p><p>attr_reader :app, :container</p><p>def initialize(app, container)
@app = app
@container = container
end</p><p>def <a href=name></a>container[name]
end
end</p><p>ServiceLocator.configure do |container|
load_environment = begin
if ENV[&lsquo;PRODUCTION_SERVICE_LOCATOR&rsquo;]
:prod
elsif Rails.env.test? || Rails.env.development?
:fake
else
:prod
end
end</p><p>case load_environment
when :fake
container.register(:sms_gateway, lambda do
Test::Nexmo::Client.new(
key: PactApi.config.nexmo.api_key,
secret: PactApi.config.nexmo.api_secret
)
end)</p><pre><code>container.register(:mailgun_client, lambda do
  Test::Mailgun::Client.new(PactApi.config.mailgun.api_key)
end)
</code></pre><p>else
container.register(:sms_gateway, lambda do
Nexmo::Client.new(
key: PactApi.config.nexmo.api_key,
secret: PactApi.config.nexmo.api_secret
)
end)</p><pre><code>container.register(:mailgun_client, lambda do
  Mailgun::Client.new(PactApi.config.mailgun.api_key)
end)
</code></pre><p>end
end</p><p>email_message.take_to_send!</p><p>mg_client = ServiceLocator[:mailgun_client]
begin
response = mg_client.send_message PactApi.config.mailgun.domain, payload</p><p>if response.code == 200
mailgun_message_id = response.to_h[&lsquo;id&rsquo;]
mailgun_message_id.gsub!(/[&lt;>]/, &lsquo;&rsquo;)
email_message.update(external_id: mailgun_message_id)
email_message.sent!
else
email_message.fail_send!
end
rescue
email_message.fail_send!
end`</p><h2 id=rail-way-coding class="relative group">Rail-way coding <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#rail-way-coding aria-label=Anchor>#</a></span></h2><p>When implementing, try to explicitly implement the true-way process.</p><h1 id=conclusion class="relative group">Conclusion <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h1></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=flex><picture class="!mb-0 !mt-0 me-4 w-24 h-auto rounded-full"><img width=2816 height=2995 class="!mb-0 !mt-0 me-4 w-24 h-auto rounded-full" alt="Andrey Kumanyaev" loading=lazy decoding=async src=https://zzet.org/img/kdauthor_hu_13d4b4a298916f43.jpeg srcset="https://zzet.org/img/kdauthor_hu_b89a404c63c2cc41.jpeg 330w,https://zzet.org/img/kdauthor_hu_13d4b4a298916f43.jpeg 660w
,https://zzet.org/img/kdauthor_hu_8e13899a507bb0aa.jpeg 1024w
,https://zzet.org/img/kdauthor_hu_8fbcf5b3caf8d913.jpeg 1320w" sizes=100vw></picture><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Andrey Kumanyaev</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Senior Engineering Manager @ Vio.com | Leading & Building High-Performance Teams & Scaling High-Load Platforms | Golang, ML, AWS, passionate about Rust</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://github.com/zzet target=_blank aria-label=Github rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://x.com/zzetorg target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://www.reddit.com/user/zzet/ target=_blank aria-label=Reddit rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://www.linkedin.com/in/andrey-kumanyaev/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a></div></div></div></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/&amp;quote=Project%20configuration.%20Part%201.%20Railsclub%20intro." title="Share on Facebook" aria-label="Share on Facebook" target=_blank rel="noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://x.com/intent/tweet/?url=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/&amp;text=Project%20configuration.%20Part%201.%20Railsclub%20intro." title="Post on X" aria-label="Post on X" target=_blank rel="noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://tootpick.org/#text=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/%20Project%20configuration.%20Part%201.%20Railsclub%20intro." title="Toot on Mastodon" aria-label="Toot on Mastodon" target=_blank rel="noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
</span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/&amp;resubmit=true&amp;title=Project%20configuration.%20Part%201.%20Railsclub%20intro." title="Submit to Reddit" aria-label="Submit to Reddit" target=_blank rel="noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/&amp;title=Project%20configuration.%20Part%201.%20Railsclub%20intro." title="Share on LinkedIn" aria-label="Share on LinkedIn" target=_blank rel="noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/&amp;subject=Project%20configuration.%20Part%201.%20Railsclub%20intro." title="Send via email" aria-label="Send via email" target=_blank rel="noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.threads.net/intent/post?text=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/%20Project%20configuration.%20Part%201.%20Railsclub%20intro." title="Post on Threads" aria-label="Post on Threads" target=_blank rel="noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M331.5 235.7c2.2.9 4.2 1.9 6.3 2.8 29.2 14.1 50.6 35.2 61.8 61.4 15.7 36.5 17.2 95.8-30.3 143.2-36.2 36.2-80.3 52.5-142.6 53h-.3c-70.2-.5-124.1-24.1-160.4-70.2-32.3-41-48.9-98.1-49.5-169.6V256v-.2C17 184.3 33.6 127.2 65.9 86.2 102.2 40.1 156.2 16.5 226.4 16h.3c70.3.5 124.9 24 162.3 69.9 18.4 22.7 32 50 40.6 81.7l-40.4 10.8c-7.1-25.8-17.8-47.8-32.2-65.4-29.2-35.8-73-54.2-130.5-54.6-57 .5-100.1 18.8-128.2 54.4C72.1 146.1 58.5 194.3 58 256c.5 61.7 14.1 109.9 40.3 143.3 28 35.6 71.2 53.9 128.2 54.4 51.4-.4 85.4-12.6 113.7-40.9 32.3-32.2 31.7-71.8 21.4-95.9-6.1-14.2-17.1-26-31.9-34.9-3.7 26.9-11.8 48.3-24.7 64.8-17.1 21.8-41.4 33.6-72.7 35.3-23.6 1.3-46.3-4.4-63.9-16-20.8-13.8-33-34.8-34.3-59.3-2.5-48.3 35.7-83 95.2-86.4 21.1-1.2 40.9-.3 59.2 2.8-2.4-14.8-7.3-26.6-14.6-35.2-10-11.7-25.6-17.7-46.2-17.8H227c-16.6.0-39 4.6-53.3 26.3l-34.4-23.6c19.2-29.1 50.3-45.1 87.8-45.1h.8c62.6.4 99.9 39.5 103.7 107.7l-.2.2zm-156 68.8c1.3 25.1 28.4 36.8 54.6 35.3 25.6-1.4 54.6-11.4 59.5-73.2-13.2-2.9-27.8-4.4-43.4-4.4-4.8.0-9.6.1-14.4.4-42.9 2.4-57.2 23.2-56.2 41.8l-.1.1z"/></svg>
</span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://telegram.me/share/url?text=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/&amp;url=Project%20configuration.%20Part%201.%20Railsclub%20intro." title="Share on Telegram" aria-label="Share on Telegram" target=_blank rel="noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=https://zzet.org/archive/2014-09-29-undev_gitlab_fork/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">About Undev Gitlab fork</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2014-09-29 00:00:00 +0000 UTC">29 September 2014</time>
</span></span></a></span><span></span></div></div></footer></article></main><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12" id=to-top hidden=true><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div><footer class="py-10 print:hidden"><nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="group mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a href=/archive/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Archive</span></a></li></ul></nav><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
Andrey Kumanyaev</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="flex flex-row items-center"><div><div class="group relative"><button class="group-dark:hover:text-primary-400 flex w-full items-center justify-end transition-colors group-hover:text-primary-600">
<span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 16 16"><path fill="currentColor" d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286H4.545zm1.634-.736L5.5 3.956h-.049l-.679 2.022H6.18z"/><path fill="currentColor" d="M0 2a2 2 0 012-2h7a2 2 0 012 2v3h3a2 2 0 012 2v7a2 2 0 01-2 2H7a2 2 0 01-2-2v-3H2A2 2 0 010 9V2zm2-1A1 1 0 001 2v7a1 1 0 001 1h7a1 1 0 001-1V2A1 1 0 009 1H2zm7.138 9.995c.193.301.402.583.63.846-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6.066 6.066.0 01-.415-.492 1.988 1.988.0 01-.94.31z"/></svg>
</span><span class=text-sm>EN</span><span class=text-[0.6rem]><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3.0l192 192c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3.0s-12.5-32.8.0-45.3l192-192z"/></svg></span></span></button><div class="bottom-7 invisible absolute z-50 flex flex-col whitespace-nowrap rounded border border-neutral-300 bg-neutral text-start text-base shadow group-hover:visible ltr:right-0 rtl:left-0 dark:border-neutral-600 dark:bg-neutral-800"><div class="flex flex-grow"><a href=https://zzet.org/archive/2017-10-29-project-configuration-railsclub-intro/ class="flex w-full items-center justify-between bg-primary-100 px-2 py-1 dark:bg-primary-900">English<span class="ms-2 w-6 text-primary-600 dark:text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M438.6 105.4c12.5 12.5 12.5 32.7.0 45.2l-256 256c-12.5 12.5-32.7 12.5-45.2.0L9.372 278.6c-12.496-12.5-12.496-32.7.0-45.2 12.498-12.5 32.758-12.5 45.258.0L159.1 338.7 393.4 105.4c12.5-12.52 32.7-12.52 45.2.0h0z"/></svg></span></span></a></div><div class="flex flex-grow"><a href=https://zzet.org/ru/archive/2017-10-29-project-configuration-railsclub-intro/ class="w-full py-1 pe-10 ps-2 decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2">Русский</a></div></div></div></div></div></div></footer></div></body></html>